import requests
import sys
import urllib

API_KEY = ""   # Your API key goes here

def fetch_result(arr):
    arr = [ x.lower() for x in arr ]
    query_str = ",".join(arr)
    url = "https://hashes.org/api.php?key=%s&query=%s" % (API_KEY, urllib.quote_plus(query_str))

    resp = requests.get(url).json()
    result = resp["result"]

    print "\n[+] Getting results from Hashes.org...\n"
    for h in arr:
        rslt = result[h]
        if rslt == None:
            print "  %s" % h
        else:
            print "  %s --> %s (%s)" % (h, rslt["plain"], rslt["algorithm"]) 
    print ""


def main():
    if len(sys.argv) == 1:
        print """
  Usage: 
  $ python hashesorg.py 739c5b1cd5681e668f689aa66bcc254c 21232f297a57a5a743894a0e4a801fc3\n"""
    else:
        fetch_result(sys.argv[1:])

main()

